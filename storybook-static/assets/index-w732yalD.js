var f;(function(s){s[s.AM=0]="AM",s[s.PM=1]="PM"})(f||(f={}));var u;(function(s){s[s.SUNDAY=0]="SUNDAY",s[s.MONDAY=1]="MONDAY",s[s.TUESDAY=2]="TUESDAY",s[s.WEDNESDAY=3]="WEDNESDAY",s[s.THURSDAY=4]="THURSDAY",s[s.FRIDAY=5]="FRIDAY",s[s.SATURDAY=6]="SATURDAY"})(u||(u={}));var T;(function(s){s[s.JANUARY=1]="JANUARY",s[s.FEBRUARY=2]="FEBRUARY",s[s.MARCH=3]="MARCH",s[s.APRIL=4]="APRIL",s[s.MAY=5]="MAY",s[s.JUNE=6]="JUNE",s[s.JULY=7]="JULY",s[s.AUGUST=8]="AUGUST",s[s.SEPTEMBER=9]="SEPTEMBER",s[s.OCTOBER=10]="OCTOBER",s[s.NOVEMBER=11]="NOVEMBER",s[s.DECEMBER=12]="DECEMBER"})(T||(T={}));function A(s,e){s.assign("day",e.getDate()),s.assign("month",e.getMonth()+1),s.assign("year",e.getFullYear())}function we(s,e){s.assign("hour",e.getHours()),s.assign("minute",e.getMinutes()),s.assign("second",e.getSeconds()),s.assign("millisecond",e.getMilliseconds()),s.assign("meridiem",e.getHours()<12?f.AM:f.PM)}function R(s,e){s.imply("day",e.getDate()),s.imply("month",e.getMonth()+1),s.imply("year",e.getFullYear())}function J(s,e){s.imply("hour",e.getHours()),s.imply("minute",e.getMinutes()),s.imply("second",e.getSeconds()),s.imply("millisecond",e.getMilliseconds()),s.imply("meridiem",e.getHours()<12?f.AM:f.PM)}const Ue={ACDT:630,ACST:570,ADT:-180,AEDT:660,AEST:600,AFT:270,AKDT:-480,AKST:-540,ALMT:360,AMST:-180,AMT:-240,ANAST:720,ANAT:720,AQTT:300,ART:-180,AST:-240,AWDT:540,AWST:480,AZOST:0,AZOT:-60,AZST:300,AZT:240,BNT:480,BOT:-240,BRST:-120,BRT:-180,BST:60,BTT:360,CAST:480,CAT:120,CCT:390,CDT:-300,CEST:120,CET:{timezoneOffsetDuringDst:120,timezoneOffsetNonDst:60,dstStart:s=>ee(s,T.MARCH,u.SUNDAY,2),dstEnd:s=>ee(s,T.OCTOBER,u.SUNDAY,3)},CHADT:825,CHAST:765,CKT:-600,CLST:-180,CLT:-240,COT:-300,CST:-360,CT:{timezoneOffsetDuringDst:-300,timezoneOffsetNonDst:-360,dstStart:s=>p(s,T.MARCH,u.SUNDAY,2,2),dstEnd:s=>p(s,T.NOVEMBER,u.SUNDAY,1,2)},CVT:-60,CXT:420,ChST:600,DAVT:420,EASST:-300,EAST:-360,EAT:180,ECT:-300,EDT:-240,EEST:180,EET:120,EGST:0,EGT:-60,EST:-300,ET:{timezoneOffsetDuringDst:-240,timezoneOffsetNonDst:-300,dstStart:s=>p(s,T.MARCH,u.SUNDAY,2,2),dstEnd:s=>p(s,T.NOVEMBER,u.SUNDAY,1,2)},FJST:780,FJT:720,FKST:-180,FKT:-240,FNT:-120,GALT:-360,GAMT:-540,GET:240,GFT:-180,GILT:720,GMT:0,GST:240,GYT:-240,HAA:-180,HAC:-300,HADT:-540,HAE:-240,HAP:-420,HAR:-360,HAST:-600,HAT:-90,HAY:-480,HKT:480,HLV:-210,HNA:-240,HNC:-360,HNE:-300,HNP:-480,HNR:-420,HNT:-150,HNY:-540,HOVT:420,ICT:420,IDT:180,IOT:360,IRDT:270,IRKST:540,IRKT:540,IRST:210,IST:330,JST:540,KGT:360,KRAST:480,KRAT:480,KST:540,KUYT:240,LHDT:660,LHST:630,LINT:840,MAGST:720,MAGT:720,MART:-510,MAWT:300,MDT:-360,MESZ:120,MEZ:60,MHT:720,MMT:390,MSD:240,MSK:180,MST:-420,MT:{timezoneOffsetDuringDst:-360,timezoneOffsetNonDst:-420,dstStart:s=>p(s,T.MARCH,u.SUNDAY,2,2),dstEnd:s=>p(s,T.NOVEMBER,u.SUNDAY,1,2)},MUT:240,MVT:300,MYT:480,NCT:660,NDT:-90,NFT:690,NOVST:420,NOVT:360,NPT:345,NST:-150,NUT:-660,NZDT:780,NZST:720,OMSST:420,OMST:420,PDT:-420,PET:-300,PETST:720,PETT:720,PGT:600,PHOT:780,PHT:480,PKT:300,PMDT:-120,PMST:-180,PONT:660,PST:-480,PT:{timezoneOffsetDuringDst:-420,timezoneOffsetNonDst:-480,dstStart:s=>p(s,T.MARCH,u.SUNDAY,2,2),dstEnd:s=>p(s,T.NOVEMBER,u.SUNDAY,1,2)},PWT:540,PYST:-180,PYT:-240,RET:240,SAMT:240,SAST:120,SBT:660,SCT:240,SGT:480,SRT:-180,SST:-660,TAHT:-600,TFT:300,TJT:300,TKT:780,TLT:540,TMT:300,TVT:720,ULAT:480,UTC:0,UYST:-120,UYT:-180,UZT:300,VET:-210,VLAST:660,VLAT:660,VUT:660,WAST:120,WAT:60,WEST:60,WESZ:60,WET:0,WEZ:0,WFT:720,WGST:-120,WGT:-180,WIB:420,WIT:540,WITA:480,WST:780,WT:0,YAKST:600,YAKT:600,YAPT:600,YEKST:360,YEKT:360};function p(s,e,t,n,r=0){let i=0,a=0;for(;a<n;)i++,new Date(s,e-1,i).getDay()===t&&a++;return new Date(s,e-1,i,r)}function ee(s,e,t,n=0){const r=t===0?7:t,i=new Date(s,e-1+1,1,12),a=i.getDay()===0?7:i.getDay();let o;return a===r?o=7:a<r?o=7+a-r:o=a-r,i.setDate(i.getDate()-o),new Date(s,e-1,i.getDate(),n)}function De(s,e,t={}){if(s==null)return null;if(typeof s=="number")return s;const n=t[s]??Ue[s];return n==null?null:typeof n=="number"?n:e==null?null:e>n.dstStart(e.getFullYear())&&!(e>n.dstEnd(e.getFullYear()))?n.timezoneOffsetDuringDst:n.timezoneOffsetNonDst}const _e={day:0,second:0,millisecond:0};function h(s,e){let t=new Date(s);if(e.y&&(e.year=e.y,delete e.y),e.mo&&(e.month=e.mo,delete e.mo),e.M&&(e.month=e.M,delete e.M),e.w&&(e.week=e.w,delete e.w),e.d&&(e.day=e.d,delete e.d),e.h&&(e.hour=e.h,delete e.h),e.m&&(e.minute=e.m,delete e.m),e.s&&(e.second=e.s,delete e.s),e.ms&&(e.millisecond=e.ms,delete e.ms),"year"in e){const n=Math.floor(e.year);t.setFullYear(t.getFullYear()+n);const r=e.year-n;r>0&&(e.month=e?.month??0,e.month+=r*12)}if("quarter"in e){const n=Math.floor(e.quarter);t.setMonth(t.getMonth()+n*3)}if("month"in e){const n=Math.floor(e.month);t.setMonth(t.getMonth()+n);const r=e.month-n;r>0&&(e.week=e?.week??0,e.week+=r*4)}if("week"in e){const n=Math.floor(e.week);t.setDate(t.getDate()+n*7);const r=e.week-n;r>0&&(e.day=e?.day??0,e.day+=Math.round(r*7))}if("day"in e){const n=Math.floor(e.day);t.setDate(t.getDate()+n);const r=e.day-n;r>0&&(e.hour=e?.hour??0,e.hour+=Math.round(r*24))}if("hour"in e){const n=Math.floor(e.hour);t.setHours(t.getHours()+n);const r=e.hour-n;r>0&&(e.minute=e?.minute??0,e.minute+=Math.round(r*60))}if("minute"in e){const n=Math.floor(e.minute);t.setMinutes(t.getMinutes()+n);const r=e.minute-n;r>0&&(e.second=e?.second??0,e.second+=Math.round(r*60))}if("second"in e){const n=Math.floor(e.second);t.setSeconds(t.getSeconds()+n);const r=e.second-n;r>0&&(e.millisecond=e?.millisecond??0,e.millisecond+=Math.round(r*1e3))}if("millisecond"in e){const n=Math.floor(e.millisecond);t.setMilliseconds(t.getMilliseconds()+n)}return t}function Y(s){const e={};for(const t in s)e[t]=-s[t];return e}class D{instant;timezoneOffset;constructor(e,t){this.instant=e??new Date,this.timezoneOffset=t??null}static fromDate(e){return new D(e)}static fromInput(e,t){if(e instanceof Date)return D.fromDate(e);const n=e?.instant??new Date,r=De(e?.timezone,n,t);return new D(n,r)}getDateWithAdjustedTimezone(){const e=new Date(this.instant);return this.timezoneOffset!==null&&e.setMinutes(e.getMinutes()-this.getSystemTimezoneAdjustmentMinute(this.instant)),e}getSystemTimezoneAdjustmentMinute(e,t){(!e||e.getTime()<0)&&(e=new Date);const n=-e.getTimezoneOffset(),r=t??this.timezoneOffset??n;return n-r}getTimezoneOffset(){return this.timezoneOffset??-this.instant.getTimezoneOffset()}}class d{knownValues;impliedValues;reference;_tags=new Set;constructor(e,t){if(this.reference=e,this.knownValues={},this.impliedValues={},t)for(const r in t)this.knownValues[r]=t[r];const n=e.getDateWithAdjustedTimezone();this.imply("day",n.getDate()),this.imply("month",n.getMonth()+1),this.imply("year",n.getFullYear()),this.imply("hour",12),this.imply("minute",0),this.imply("second",0),this.imply("millisecond",0)}static createRelativeFromReference(e,t=_e){let n=h(e.getDateWithAdjustedTimezone(),t);const r=new d(e);return r.addTag("result/relativeDate"),"hour"in t||"minute"in t||"second"in t||"millisecond"in t?(r.addTag("result/relativeDateAndTime"),we(r,n),A(r,n),r.assign("timezoneOffset",e.getTimezoneOffset())):(J(r,n),r.imply("timezoneOffset",e.getTimezoneOffset()),"day"in t?(r.assign("day",n.getDate()),r.assign("month",n.getMonth()+1),r.assign("year",n.getFullYear()),r.assign("weekday",n.getDay())):"week"in t?(r.assign("day",n.getDate()),r.assign("month",n.getMonth()+1),r.assign("year",n.getFullYear()),r.imply("weekday",n.getDay())):(r.imply("day",n.getDate()),"month"in t?(r.assign("month",n.getMonth()+1),r.assign("year",n.getFullYear())):(r.imply("month",n.getMonth()+1),"year"in t?r.assign("year",n.getFullYear()):r.imply("year",n.getFullYear())))),r}get(e){return e in this.knownValues?this.knownValues[e]:e in this.impliedValues?this.impliedValues[e]:null}isCertain(e){return e in this.knownValues}getCertainComponents(){return Object.keys(this.knownValues)}imply(e,t){return e in this.knownValues?this:(this.impliedValues[e]=t,this)}assign(e,t){return this.knownValues[e]=t,delete this.impliedValues[e],this}addDurationAsImplied(e){const t=this.dateWithoutTimezoneAdjustment(),n=h(t,e);return("day"in e||"week"in e||"month"in e||"year"in e)&&(this.delete(["day","weekday","month","year"]),this.imply("day",n.getDate()),this.imply("weekday",n.getDay()),this.imply("month",n.getMonth()+1),this.imply("year",n.getFullYear())),("second"in e||"minute"in e||"hour"in e)&&(this.delete(["second","minute","hour"]),this.imply("second",n.getSeconds()),this.imply("minute",n.getMinutes()),this.imply("hour",n.getHours())),this}delete(e){typeof e=="string"&&(e=[e]);for(const t of e)delete this.knownValues[t],delete this.impliedValues[t]}clone(){const e=new d(this.reference);e.knownValues={},e.impliedValues={};for(const t in this.knownValues)e.knownValues[t]=this.knownValues[t];for(const t in this.impliedValues)e.impliedValues[t]=this.impliedValues[t];return e}isOnlyDate(){return!this.isCertain("hour")&&!this.isCertain("minute")&&!this.isCertain("second")}isOnlyTime(){return!this.isCertain("weekday")&&!this.isCertain("day")&&!this.isCertain("month")&&!this.isCertain("year")}isOnlyWeekdayComponent(){return this.isCertain("weekday")&&!this.isCertain("day")&&!this.isCertain("month")}isDateWithUnknownYear(){return this.isCertain("month")&&!this.isCertain("year")}isValidDate(){const e=this.dateWithoutTimezoneAdjustment();return!(e.getFullYear()!==this.get("year")||e.getMonth()!==this.get("month")-1||e.getDate()!==this.get("day")||this.get("hour")!=null&&e.getHours()!=this.get("hour")||this.get("minute")!=null&&e.getMinutes()!=this.get("minute"))}toString(){return`[ParsingComponents {
            tags: ${JSON.stringify(Array.from(this._tags).sort())}, 
            knownValues: ${JSON.stringify(this.knownValues)}, 
            impliedValues: ${JSON.stringify(this.impliedValues)}}, 
            reference: ${JSON.stringify(this.reference)}]`}date(){const e=this.dateWithoutTimezoneAdjustment(),t=this.reference.getSystemTimezoneAdjustmentMinute(e,this.get("timezoneOffset"));return new Date(e.getTime()+t*6e4)}addTag(e){return this._tags.add(e),this}addTags(e){for(const t of e)this._tags.add(t);return this}tags(){return new Set(this._tags)}dateWithoutTimezoneAdjustment(){const e=new Date(this.get("year"),this.get("month")-1,this.get("day"),this.get("hour"),this.get("minute"),this.get("second"),this.get("millisecond"));return e.setFullYear(this.get("year")),e}}class M{refDate;index;text;reference;start;end;constructor(e,t,n,r,i){this.reference=e,this.refDate=e.instant,this.index=t,this.text=n,this.start=r||new d(e),this.end=i}clone(){const e=new M(this.reference,this.index,this.text);return e.start=this.start?this.start.clone():null,e.end=this.end?this.end.clone():null,e}date(){return this.start.date()}addTag(e){return this.start.addTag(e),this.end&&this.end.addTag(e),this}addTags(e){return this.start.addTags(e),this.end&&this.end.addTags(e),this}tags(){const e=new Set(this.start.tags());if(this.end)for(const t of this.end.tags())e.add(t);return e}toString(){const e=Array.from(this.tags()).sort();return`[ParsingResult {index: ${this.index}, text: '${this.text}', tags: ${JSON.stringify(e)} ...}]`}}function Ae(s,e,t="\\s{0,5},?\\s{0,5}"){const n=e.replace(/\((?!\?)/g,"(?:");return`${s}${n}(?:${t}${n}){0,10}`}function Ie(s){let e;return s instanceof Array?e=[...s]:s instanceof Map?e=Array.from(s.keys()):e=Object.keys(s),e}function y(s){return`(?:${Ie(s).sort((t,n)=>n.length-t.length).join("|").replace(/\./g,"\\.")})`}function Pe(s){return s<100&&(s>50?s=s+1900:s=s+2e3),s}function b(s,e,t){let n=new Date(s);n.setMonth(t-1),n.setDate(e);const r=h(n,{year:1}),i=h(n,{year:-1});return Math.abs(r.getTime()-s.getTime())<Math.abs(n.getTime()-s.getTime())?n=r:Math.abs(i.getTime()-s.getTime())<Math.abs(n.getTime()-s.getTime())&&(n=i),n.getFullYear()}const V={sunday:0,sun:0,"sun.":0,monday:1,mon:1,"mon.":1,tuesday:2,tue:2,"tue.":2,wednesday:3,wed:3,"wed.":3,thursday:4,thurs:4,"thurs.":4,thur:4,"thur.":4,thu:4,"thu.":4,friday:5,fri:5,"fri.":5,saturday:6,sat:6,"sat.":6},Re={january:1,february:2,march:3,april:4,may:5,june:6,july:7,august:8,september:9,october:10,november:11,december:12},E={...Re,jan:1,"jan.":1,feb:2,"feb.":2,mar:3,"mar.":3,apr:4,"apr.":4,jun:6,"jun.":6,jul:7,"jul.":7,aug:8,"aug.":8,sep:9,"sep.":9,sept:9,"sept.":9,oct:10,"oct.":10,nov:11,"nov.":11,dec:12,"dec.":12},j={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12},Z={first:1,second:2,third:3,fourth:4,fifth:5,sixth:6,seventh:7,eighth:8,ninth:9,tenth:10,eleventh:11,twelfth:12,thirteenth:13,fourteenth:14,fifteenth:15,sixteenth:16,seventeenth:17,eighteenth:18,nineteenth:19,twentieth:20,"twenty first":21,"twenty-first":21,"twenty second":22,"twenty-second":22,"twenty third":23,"twenty-third":23,"twenty fourth":24,"twenty-fourth":24,"twenty fifth":25,"twenty-fifth":25,"twenty sixth":26,"twenty-sixth":26,"twenty seventh":27,"twenty-seventh":27,"twenty eighth":28,"twenty-eighth":28,"twenty ninth":29,"twenty-ninth":29,thirtieth:30,"thirty first":31,"thirty-first":31},Ne={second:"second",seconds:"second",minute:"minute",minutes:"minute",hour:"hour",hours:"hour",day:"day",days:"day",week:"week",weeks:"week",month:"month",months:"month",quarter:"quarter",quarters:"quarter",year:"year",years:"year"},W={s:"second",sec:"second",second:"second",seconds:"second",m:"minute",min:"minute",mins:"minute",minute:"minute",minutes:"minute",h:"hour",hr:"hour",hrs:"hour",hour:"hour",hours:"hour",d:"day",day:"day",days:"day",w:"week",week:"week",weeks:"week",mo:"month",mon:"month",mos:"month",month:"month",months:"month",qtr:"quarter",quarter:"quarter",quarters:"quarter",y:"year",yr:"year",year:"year",years:"year",...Ne},Me=`(?:${y(j)}|[0-9]+|[0-9]+\\.[0-9]+|half(?:\\s{0,2}an?)?|an?\\b(?:\\s{0,2}few)?|few|several|the|a?\\s{0,2}couple\\s{0,2}(?:of)?)`;function Fe(s){const e=s.toLowerCase();return j[e]!==void 0?j[e]:e==="a"||e==="an"||e=="the"?1:e.match(/few/)?3:e.match(/half/)?.5:e.match(/couple/)?2:e.match(/several/)?7:parseFloat(e)}const I=`(?:${y(Z)}|[0-9]{1,2}(?:st|nd|rd|th)?)`;function F(s){let e=s.toLowerCase();return Z[e]!==void 0?Z[e]:(e=e.replace(/(?:st|nd|rd|th)$/i,""),parseInt(e))}const k="(?:[1-9][0-9]{0,3}\\s{0,2}(?:BE|AD|BC|BCE|CE)|[1-2][0-9]{3}|[5-9][0-9]|2[0-5])";function z(s){if(/BE/i.test(s))return s=s.replace(/BE/i,""),parseInt(s)-543;if(/BCE?/i.test(s))return s=s.replace(/BCE?/i,""),-parseInt(s);if(/(AD|CE)/i.test(s))return s=s.replace(/(AD|CE)/i,""),parseInt(s);const e=parseInt(s);return Pe(e)}const Oe=`(${Me})\\s{0,3}(${y(W)})`,te=new RegExp(Oe,"i"),Ye=`(${Me})\\s{0,3}(${y(Ne)})`,xe="\\s{0,5},?(?:\\s*and)?\\s{0,5}",S=Ae("(?:(?:about|around)\\s{0,3})?",Oe,xe),G=Ae("(?:(?:about|around)\\s{0,3})?",Ye,xe);function O(s){const e={};let t=s,n=te.exec(t);for(;n;)be(e,n),t=t.substring(n[0].length).trim(),n=te.exec(t);return Object.keys(e).length==0?null:e}function be(s,e){if(e[0].match(/^[a-zA-Z]+$/))return;const t=Fe(e[1]),n=W[e[2].toLowerCase()];s[n]=t}class m{innerPatternHasChange(e,t){return this.innerPattern(e)!==t}patternLeftBoundary(){return"(\\W|^)"}cachedInnerPattern=null;cachedPattern=null;pattern(e){return this.cachedInnerPattern&&!this.innerPatternHasChange(e,this.cachedInnerPattern)?this.cachedPattern:(this.cachedInnerPattern=this.innerPattern(e),this.cachedPattern=new RegExp(`${this.patternLeftBoundary()}${this.cachedInnerPattern.source}`,this.cachedInnerPattern.flags),this.cachedPattern)}extract(e,t){const n=t[1]??"";t.index=t.index+n.length,t[0]=t[0].substring(n.length);for(let r=2;r<t.length;r++)t[r-1]=t[r];return this.innerExtract(e,t)}}const We=new RegExp(`(?:(?:within|in|for)\\s*)?(?:(?:about|around|roughly|approximately|just)\\s*(?:~\\s*)?)?(${S})(?=\\W|$)`,"i"),ke=new RegExp(`(?:within|in|for)\\s*(?:(?:about|around|roughly|approximately|just)\\s*(?:~\\s*)?)?(${S})(?=\\W|$)`,"i"),ze=new RegExp(`(?:within|in|for)\\s*(?:(?:about|around|roughly|approximately|just)\\s*(?:~\\s*)?)?(${G})(?=\\W|$)`,"i");class Ge extends m{strictMode;constructor(e){super(),this.strictMode=e}innerPattern(e){return this.strictMode?ze:e.option.forwardDate?We:ke}innerExtract(e,t){if(t[0].match(/^for\s*the\s*\w+/))return null;const n=O(t[1]);return n?d.createRelativeFromReference(e.reference,n):null}}const Be=new RegExp(`(?:on\\s{0,3})?(${I})(?:\\s{0,3}(?:to|\\-|\\–|until|through|till)?\\s{0,3}(${I}))?(?:-|/|\\s{0,3}(?:of)?\\s{0,3})(${y(E)})(?:(?:-|/|,?\\s{0,3})(${k}(?!\\w)))?(?=\\W|$)`,"i"),ne=1,se=2,He=3,re=4;class ve extends m{innerPattern(){return Be}innerExtract(e,t){const n=e.createParsingResult(t.index,t[0]),r=E[t[He].toLowerCase()],i=F(t[ne]);if(i>31)return t.index=t.index+t[ne].length,null;if(n.start.assign("month",r),n.start.assign("day",i),t[re]){const a=z(t[re]);n.start.assign("year",a)}else{const a=b(e.refDate,i,r);n.start.imply("year",a)}if(t[se]){const a=F(t[se]);n.end=n.start.clone(),n.end.assign("day",a)}return n}}const Le=new RegExp(`(${y(E)})(?:-|/|\\s*,?\\s*)(${I})(?!\\s*(?:am|pm))\\s*(?:(?:to|\\-)\\s*(${I})\\s*)?(?:(?:-|/|\\s*,\\s*|\\s+)(${k}))?(?=\\W|$)(?!\\:\\d)`,"i"),Ve=1,ie=2,B=3,H=4;class je extends m{shouldSkipYearLikeDate;constructor(e){super(),this.shouldSkipYearLikeDate=e}innerPattern(){return Le}innerExtract(e,t){const n=E[t[Ve].toLowerCase()],r=F(t[ie]);if(r>31||this.shouldSkipYearLikeDate&&!t[B]&&!t[H]&&t[ie].match(/^2[0-5]$/))return null;const i=e.createParsingComponents({day:r,month:n}).addTag("parser/ENMonthNameMiddleEndianParser");if(t[H]){const l=z(t[H]);i.assign("year",l)}else{const l=b(e.refDate,r,n);i.imply("year",l)}if(!t[B])return i;const a=F(t[B]),o=e.createParsingResult(t.index,t[0]);return o.start=i,o.end=i.clone(),o.end.assign("day",a),o}}const Ze=new RegExp(`((?:in)\\s*)?(${y(E)})\\s*(?:(?:,|-|of)?\\s*(${k})?)?(?=[^\\s\\w]|\\s+[^0-9]|\\s+$|$)`,"i"),Ke=1,Je=2,ae=3;class qe extends m{innerPattern(){return Ze}innerExtract(e,t){const n=t[Je].toLowerCase();if(t[0].length<=3&&!Re[n])return null;const r=e.createParsingResult(t.index+(t[Ke]||"").length,t.index+t[0].length);r.start.imply("day",1),r.start.addTag("parser/ENMonthNameParser");const i=E[n];if(r.start.assign("month",i),t[ae]){const a=z(t[ae]);r.start.assign("year",a)}else{const a=b(e.refDate,1,i);r.start.imply("year",a)}return r}}const Xe=new RegExp(`([0-9]{4})[-\\.\\/\\s](?:(${y(E)})|([0-9]{1,2}))[-\\.\\/\\s]([0-9]{1,2})(?=\\W|$)`,"i"),Qe=1,et=2,oe=3,tt=4;class nt extends m{strictMonthDateOrder;constructor(e){super(),this.strictMonthDateOrder=e}innerPattern(){return Xe}innerExtract(e,t){const n=parseInt(t[Qe]);let r=parseInt(t[tt]),i=t[oe]?parseInt(t[oe]):E[t[et].toLowerCase()];if(i<1||i>12){if(this.strictMonthDateOrder)return null;r>=1&&r<=12&&([i,r]=[r,i])}return r<1||r>31?null:{day:r,month:i,year:n}}}const st=new RegExp("([0-9]|0[1-9]|1[012])/([0-9]{4})","i"),rt=1,it=2;class at extends m{innerPattern(){return st}innerExtract(e,t){const n=parseInt(t[it]),r=parseInt(t[rt]);return e.createParsingComponents().imply("day",1).assign("month",r).assign("year",n)}}function ot(s,e,t,n){return new RegExp(`${s}${e}(\\d{1,4})(?:(?:\\.|:|：)(\\d{1,2})(?:(?::|：)(\\d{2})(?:\\.(\\d{1,6}))?)?)?(?:\\s*(a\\.m\\.|p\\.m\\.|am?|pm?))?${t}`,n)}function lt(s,e){return new RegExp(`^(${s})(\\d{1,4})(?:(?:\\.|\\:|\\：)(\\d{1,2})(?:(?:\\.|\\:|\\：)(\\d{1,2})(?:\\.(\\d{1,6}))?)?)?(?:\\s*(a\\.m\\.|p\\.m\\.|am?|pm?))?${e}`,"i")}const v=2,w=3,C=4,U=5,P=6;class ft{strictMode;constructor(e=!1){this.strictMode=e}patternFlags(){return"i"}primaryPatternLeftBoundary(){return"(^|\\s|T|\\b)"}primarySuffix(){return"(?!/)(?=\\W|$)"}followingSuffix(){return"(?!/)(?=\\W|$)"}pattern(e){return this.getPrimaryTimePatternThroughCache()}extract(e,t){const n=this.extractPrimaryTimeComponents(e,t);if(!n)return t[0].match(/^\d{4}/)?(t.index+=4,null):(t.index+=t[0].length,null);const r=t.index+t[1].length,i=t[0].substring(t[1].length),a=e.createParsingResult(r,i,n);t.index+=t[0].length;const o=e.text.substring(t.index),c=this.getFollowingTimePatternThroughCache().exec(o);return i.match(/^\d{3,4}/)&&c&&(c[0].match(/^\s*([+-])\s*\d{2,4}$/)||c[0].match(/^\s*([+-])\s*\d{2}\W\d{2}/))?null:!c||c[0].match(/^\s*([+-])\s*\d{3,4}$/)?this.checkAndReturnWithoutFollowingPattern(a):(a.end=this.extractFollowingTimeComponents(e,c,a),a.end&&(a.text+=c[0]),this.checkAndReturnWithFollowingPattern(a))}extractPrimaryTimeComponents(e,t,n=!1){const r=e.createParsingComponents();let i=0,a=null,o=parseInt(t[v]);if(o>100){if(t[v].length==4&&t[w]==null&&!t[P]||this.strictMode||t[w]!=null)return null;i=o%100,o=Math.floor(o/100)}if(o>24)return null;if(t[w]!=null){if(t[w].length==1&&!t[P])return null;i=parseInt(t[w])}if(i>=60)return null;if(o>12&&(a=f.PM),t[P]!=null){if(o>12)return null;const l=t[P][0].toLowerCase();l=="a"&&(a=f.AM,o==12&&(o=0)),l=="p"&&(a=f.PM,o!=12&&(o+=12))}if(r.assign("hour",o),r.assign("minute",i),a!==null?r.assign("meridiem",a):o<12?r.imply("meridiem",f.AM):r.imply("meridiem",f.PM),t[U]!=null){const l=parseInt(t[U].substring(0,3));if(l>=1e3)return null;r.assign("millisecond",l)}if(t[C]!=null){const l=parseInt(t[C]);if(l>=60)return null;r.assign("second",l)}return r}extractFollowingTimeComponents(e,t,n){const r=e.createParsingComponents();if(t[U]!=null){const l=parseInt(t[U].substring(0,3));if(l>=1e3)return null;r.assign("millisecond",l)}if(t[C]!=null){const l=parseInt(t[C]);if(l>=60)return null;r.assign("second",l)}let i=parseInt(t[v]),a=0,o=-1;if(t[w]!=null?a=parseInt(t[w]):i>100&&(a=i%100,i=Math.floor(i/100)),a>=60||i>24)return null;if(i>=12&&(o=f.PM),t[P]!=null){if(i>12)return null;const l=t[P][0].toLowerCase();l=="a"&&(o=f.AM,i==12&&(i=0,r.isCertain("day")||r.imply("day",r.get("day")+1))),l=="p"&&(o=f.PM,i!=12&&(i+=12)),n.start.isCertain("meridiem")||(o==f.AM?(n.start.imply("meridiem",f.AM),n.start.get("hour")==12&&n.start.assign("hour",0)):(n.start.imply("meridiem",f.PM),n.start.get("hour")!=12&&n.start.assign("hour",n.start.get("hour")+12)))}return r.assign("hour",i),r.assign("minute",a),o>=0?r.assign("meridiem",o):n.start.isCertain("meridiem")&&n.start.get("hour")>12?n.start.get("hour")-12>i?r.imply("meridiem",f.AM):i<=12&&(r.assign("hour",i+12),r.assign("meridiem",f.PM)):i>12?r.imply("meridiem",f.PM):i<=12&&r.imply("meridiem",f.AM),r.date().getTime()<n.start.date().getTime()&&r.imply("day",r.get("day")+1),r}checkAndReturnWithoutFollowingPattern(e){if(e.text.match(/^\d$/)||e.text.match(/^\d\d\d+$/)||e.text.match(/\d[apAP]$/))return null;const t=e.text.match(/[^\d:.](\d[\d.]+)$/);if(t){const n=t[1];if(this.strictMode||n.includes(".")&&!n.match(/\d(\.\d{2})+$/)||parseInt(n)>24)return null}return e}checkAndReturnWithFollowingPattern(e){if(e.text.match(/^\d+-\d+$/))return null;const t=e.text.match(/[^\d:.](\d[\d.]+)\s*-\s*(\d[\d.]+)$/);if(t){if(this.strictMode)return null;const n=t[1],r=t[2];if(r.includes(".")&&!r.match(/\d(\.\d{2})+$/))return null;const i=parseInt(r),a=parseInt(n);if(i>24||a>24)return null}return e}cachedPrimaryPrefix=null;cachedPrimarySuffix=null;cachedPrimaryTimePattern=null;getPrimaryTimePatternThroughCache(){const e=this.primaryPrefix(),t=this.primarySuffix();return this.cachedPrimaryPrefix===e&&this.cachedPrimarySuffix===t?this.cachedPrimaryTimePattern:(this.cachedPrimaryTimePattern=ot(this.primaryPatternLeftBoundary(),e,t,this.patternFlags()),this.cachedPrimaryPrefix=e,this.cachedPrimarySuffix=t,this.cachedPrimaryTimePattern)}cachedFollowingPhase=null;cachedFollowingSuffix=null;cachedFollowingTimePatten=null;getFollowingTimePatternThroughCache(){const e=this.followingPhase(),t=this.followingSuffix();return this.cachedFollowingPhase===e&&this.cachedFollowingSuffix===t?this.cachedFollowingTimePatten:(this.cachedFollowingTimePatten=lt(e,t),this.cachedFollowingPhase=e,this.cachedFollowingSuffix=t,this.cachedFollowingTimePatten)}}class ct extends ft{constructor(e){super(e)}followingPhase(){return"\\s*(?:\\-|\\–|\\~|\\〜|to|until|through|till|\\?)\\s*"}primaryPrefix(){return"(?:(?:at|from)\\s*)??"}primarySuffix(){return"(?:\\s*(?:o\\W*clock|at\\s*night|in\\s*the\\s*(?:morning|afternoon)))?(?!/)(?=\\W|$)"}extractPrimaryTimeComponents(e,t){const n=super.extractPrimaryTimeComponents(e,t);if(!n)return n;if(t[0].endsWith("night")){const r=n.get("hour");r>=6&&r<12?(n.assign("hour",n.get("hour")+12),n.assign("meridiem",f.PM)):r<6&&n.assign("meridiem",f.AM)}if(t[0].endsWith("afternoon")){n.assign("meridiem",f.PM);const r=n.get("hour");r>=0&&r<=6&&n.assign("hour",n.get("hour")+12)}return t[0].endsWith("morning")&&(n.assign("meridiem",f.AM),n.get("hour")<12&&n.assign("hour",n.get("hour"))),n.addTag("parser/ENTimeExpressionParser")}extractFollowingTimeComponents(e,t,n){const r=super.extractFollowingTimeComponents(e,t,n);return r&&r.addTag("parser/ENTimeExpressionParser"),r}}const dt=new RegExp(`(${S})\\s{0,5}(?:ago|before|earlier)(?=\\W|$)`,"i"),ut=new RegExp(`(${G})\\s{0,5}(?:ago|before|earlier)(?=\\W|$)`,"i");class gt extends m{strictMode;constructor(e){super(),this.strictMode=e}innerPattern(){return this.strictMode?ut:dt}innerExtract(e,t){const n=O(t[1]);return n?d.createRelativeFromReference(e.reference,Y(n)):null}}const ht=new RegExp(`(${S})\\s{0,5}(?:later|after|from now|henceforth|forward|out)(?=(?:\\W|$))`,"i"),mt=new RegExp(`(${G})\\s{0,5}(later|after|from now)(?=\\W|$)`,"i"),Tt=1;class yt extends m{strictMode;constructor(e){super(),this.strictMode=e}innerPattern(){return this.strictMode?mt:ht}innerExtract(e,t){const n=O(t[Tt]);return n?d.createRelativeFromReference(e.reference,n):null}}class Se{refine(e,t){return t.filter(n=>this.isValid(e,n))}}class ${refine(e,t){if(t.length<2)return t;const n=[];let r=t[0],i=null;for(let a=1;a<t.length;a++){i=t[a];const o=e.text.substring(r.index+r.text.length,i.index);if(!this.shouldMergeResults(o,r,i,e))n.push(r),r=i;else{const l=r,c=i,g=this.mergeResults(o,l,c,e);e.debug(()=>{console.log(`${this.constructor.name} merged ${l} and ${c} into ${g}`)}),r=g}}return r!=null&&n.push(r),n}}class pt extends ${shouldMergeResults(e,t,n){return!t.end&&!n.end&&e.match(this.patternBetween())!=null}mergeResults(e,t,n){if(!t.start.isOnlyWeekdayComponent()&&!n.start.isOnlyWeekdayComponent()&&(n.start.getCertainComponents().forEach(i=>{t.start.isCertain(i)||t.start.imply(i,n.start.get(i))}),t.start.getCertainComponents().forEach(i=>{n.start.isCertain(i)||n.start.imply(i,t.start.get(i))})),t.start.date()>n.start.date()){let i=t.start.date(),a=n.start.date();n.start.isOnlyWeekdayComponent()&&h(a,{day:7})>i?(a=h(a,{day:7}),n.start.imply("day",a.getDate()),n.start.imply("month",a.getMonth()+1),n.start.imply("year",a.getFullYear())):t.start.isOnlyWeekdayComponent()&&h(i,{day:-7})<a?(i=h(i,{day:-7}),t.start.imply("day",i.getDate()),t.start.imply("month",i.getMonth()+1),t.start.imply("year",i.getFullYear())):n.start.isDateWithUnknownYear()&&h(a,{year:1})>i?(a=h(a,{year:1}),n.start.imply("year",a.getFullYear())):t.start.isDateWithUnknownYear()&&h(i,{year:-1})<a?(i=h(i,{year:-1}),t.start.imply("year",i.getFullYear())):[n,t]=[t,n]}const r=t.clone();return r.start=t.start,r.end=n.start,r.index=Math.min(t.index,n.index),t.index<n.index?r.text=t.text+e+n.text:r.text=n.text+e+t.text,r}}class Et extends pt{patternBetween(){return/^\s*(to|-|–|until|through|till)\s*$/i}}function le(s,e){const t=s.clone(),n=s.start,r=e.start;if(t.start=fe(n,r),s.end!=null||e.end!=null){const i=s.end==null?s.start:s.end,a=e.end==null?e.start:e.end,o=fe(i,a);if(s.end==null&&o.date().getTime()<t.start.date().getTime()){const l=new Date(o.date().getTime());l.setDate(l.getDate()+1),o.isCertain("day")?A(o,l):R(o,l)}t.end=o}return t}function fe(s,e){const t=s.clone();return e.isCertain("hour")?(t.assign("hour",e.get("hour")),t.assign("minute",e.get("minute")),e.isCertain("second")?(t.assign("second",e.get("second")),e.isCertain("millisecond")?t.assign("millisecond",e.get("millisecond")):t.imply("millisecond",e.get("millisecond"))):(t.imply("second",e.get("second")),t.imply("millisecond",e.get("millisecond")))):(t.imply("hour",e.get("hour")),t.imply("minute",e.get("minute")),t.imply("second",e.get("second")),t.imply("millisecond",e.get("millisecond"))),e.isCertain("timezoneOffset")&&t.assign("timezoneOffset",e.get("timezoneOffset")),e.isCertain("meridiem")?t.assign("meridiem",e.get("meridiem")):e.get("meridiem")!=null&&t.get("meridiem")==null&&t.imply("meridiem",e.get("meridiem")),t.get("meridiem")==f.PM&&t.get("hour")<12&&(e.isCertain("hour")?t.assign("hour",t.get("hour")+12):t.imply("hour",t.get("hour")+12)),t.addTags(s.tags()),t.addTags(e.tags()),t}class wt extends ${shouldMergeResults(e,t,n){return(t.start.isOnlyDate()&&n.start.isOnlyTime()||n.start.isOnlyDate()&&t.start.isOnlyTime())&&e.match(this.patternBetween())!=null}mergeResults(e,t,n){const r=t.start.isOnlyDate()?le(t,n):le(n,t);return r.index=t.index,r.text=t.text+e+n.text,r}}class ce extends wt{patternBetween(){return new RegExp("^\\s*(T|at|after|before|on|of|,|-|\\.|∙|:)?\\s*$")}}const Dt=new RegExp("^\\s*,?\\s*\\(?([A-Z]{2,4})\\)?(?=\\W|$)","i");class At{timezoneOverrides;constructor(e){this.timezoneOverrides=e}refine(e,t){const n=e.option.timezones??{};return t.forEach(r=>{const i=e.text.substring(r.index+r.text.length),a=Dt.exec(i);if(!a)return;const o=a[1].toUpperCase(),l=r.start.date()??r.refDate??new Date,c={...this.timezoneOverrides,...n},g=De(o,l,c);if(g==null)return;e.debug(()=>{console.log(`Extracting timezone: '${o}' into: ${g} for: ${r.start}`)});const x=r.start.get("timezoneOffset");x!==null&&g!=x&&(r.start.isCertain("timezoneOffset")||o!=a[1])||r.start.isOnlyDate()&&o!=a[1]||(r.text+=a[0],r.start.isCertain("timezoneOffset")||r.start.assign("timezoneOffset",g),r.end!=null&&!r.end.isCertain("timezoneOffset")&&r.end.assign("timezoneOffset",g))}),t}}const Pt=new RegExp("^\\s*(?:\\(?(?:GMT|UTC)\\s?)?([+-])(\\d{1,2})(?::?(\\d{2}))?\\)?","i"),Rt=1,Nt=2,Mt=3;class Ot{refine(e,t){return t.forEach(function(n){if(n.start.isCertain("timezoneOffset"))return;const r=e.text.substring(n.index+n.text.length),i=Pt.exec(r);if(!i)return;e.debug(()=>{console.log(`Extracting timezone: '${i[0]}' into : ${n}`)});const a=parseInt(i[Nt]),o=parseInt(i[Mt]||"0");let l=a*60+o;l>840||(i[Rt]==="-"&&(l=-l),n.end!=null&&n.end.assign("timezoneOffset",l),n.start.assign("timezoneOffset",l),n.text+=i[0])}),t}}class K{refine(e,t){if(t.length<2)return t;const n=[];let r=t[0];for(let i=1;i<t.length;i++){const a=t[i];if(a.index>=r.index+r.text.length){n.push(r),r=a;continue}let o=null,l=null;a.text.length>r.text.length?(o=a,l=r):(o=r,l=a),e.debug(()=>{console.log(`${this.constructor.name} remove ${l} by ${o}`)}),r=o}return r!=null&&n.push(r),n}}class xt{refine(e,t){return e.option.forwardDate&&t.forEach(n=>{let r=e.reference.getDateWithAdjustedTimezone();if(n.start.isOnlyTime()&&e.reference.instant>n.start.date()){const i=e.reference.getDateWithAdjustedTimezone(),a=new Date(i);a.setDate(a.getDate()+1),R(n.start,a),e.debug(()=>{console.log(`${this.constructor.name} adjusted ${n} time from the ref date (${i}) to the following day (${a})`)}),n.end&&n.end.isOnlyTime()&&(R(n.end,a),n.start.date()>n.end.date()&&(a.setDate(a.getDate()+1),R(n.end,a)))}if(n.start.isOnlyWeekdayComponent()&&r>n.start.date()){let i=n.start.get("weekday")-r.getDay();if(i<=0&&(i+=7),r=h(r,{day:i}),R(n.start,r),e.debug(()=>{console.log(`${this.constructor.name} adjusted ${n} weekday (${n.start})`)}),n.end&&n.end.isOnlyWeekdayComponent()){let a=n.end.get("weekday")-r.getDay();a<=0&&(a+=7),r=h(r,{day:a}),R(n.end,r),e.debug(()=>{console.log(`${this.constructor.name} adjusted ${n} weekday (${n.end})`)})}}if(n.start.isDateWithUnknownYear()&&r>n.start.date())for(let i=0;i<3&&r>n.start.date();i++)n.start.imply("year",n.start.get("year")+1),e.debug(()=>{console.log(`${this.constructor.name} adjusted ${n} year (${n.start})`)}),n.end&&!n.end.isCertain("year")&&(n.end.imply("year",n.end.get("year")+1),e.debug(()=>{console.log(`${this.constructor.name} adjusted ${n} month (${n.start})`)}))}),t}}class St extends Se{strictMode;constructor(e){super(),this.strictMode=e}isValid(e,t){return t.text.replace(" ","").match(/^\d*(\.\d*)?$/)?(e.debug(()=>{console.log(`Removing unlikely result '${t.text}'`)}),!1):t.start.isValidDate()?t.end&&!t.end.isValidDate()?(e.debug(()=>{console.log(`Removing invalid result: ${t} (${t.end})`)}),!1):this.strictMode?this.isStrictModeValid(e,t):!0:(e.debug(()=>{console.log(`Removing invalid result: ${t} (${t.start})`)}),!1)}isStrictModeValid(e,t){return t.start.isOnlyWeekdayComponent()?(e.debug(()=>{console.log(`(Strict) Removing weekday only component: ${t} (${t.end})`)}),!1):!0}}const $t=new RegExp("([0-9]{4})\\-([0-9]{1,2})\\-([0-9]{1,2})(?:T([0-9]{1,2}):([0-9]{1,2})(?::([0-9]{1,2})(?:\\.(\\d{1,4}))?)?(Z|([+-]\\d{2}):?(\\d{2})?)?)?(?=\\W|$)","i"),Ct=1,Ut=2,_t=3,de=4,It=5,ue=6,ge=7,Ft=8,he=9,me=10;class Yt extends m{innerPattern(){return $t}innerExtract(e,t){const n=e.createParsingComponents({year:parseInt(t[Ct]),month:parseInt(t[Ut]),day:parseInt(t[_t])});if(t[de]!=null&&(n.assign("hour",parseInt(t[de])),n.assign("minute",parseInt(t[It])),t[ue]!=null&&n.assign("second",parseInt(t[ue])),t[ge]!=null&&n.assign("millisecond",parseInt(t[ge])),t[Ft]!=null)){let r=0;if(t[he]){const i=parseInt(t[he]);let a=0;t[me]!=null&&(a=parseInt(t[me])),r=i*60,r<0?r-=a:r+=a}n.assign("timezoneOffset",r)}return n.addTag("parser/ISOFormatParser")}}class bt extends ${mergeResults(e,t,n){const r=n.clone();return r.index=t.index,r.text=t.text+e+r.text,r.start.assign("weekday",t.start.get("weekday")),r.end&&r.end.assign("weekday",t.start.get("weekday")),r}shouldMergeResults(e,t,n){return t.start.isOnlyWeekdayComponent()&&!t.start.isCertain("hour")&&n.start.isCertain("day")&&e.match(/^,?\s*$/)!=null}}function Wt(s,e=!1){return s.parsers.unshift(new Yt),s.refiners.unshift(new bt),s.refiners.unshift(new Ot),s.refiners.unshift(new K),s.refiners.push(new At),s.refiners.push(new K),s.refiners.push(new xt),s.refiners.push(new St(e)),s}function kt(s){const e=s.getDateWithAdjustedTimezone(),t=new d(s,{});return A(t,e),we(t,e),t.assign("timezoneOffset",s.getTimezoneOffset()),t.addTag("casualReference/now"),t}function zt(s){const e=s.getDateWithAdjustedTimezone(),t=new d(s,{});return A(t,e),J(t,e),t.delete("meridiem"),t.addTag("casualReference/today"),t}function Gt(s){return Ht(s).addTag("casualReference/yesterday")}function Bt(s){return q(s,1).addTag("casualReference/tomorrow")}function Ht(s,e){return q(s,-1)}function q(s,e){const t=s.getDateWithAdjustedTimezone(),n=new d(s,{}),r=new Date(t.getTime());return r.setDate(r.getDate()+e),A(n,r),J(n,r),n.delete("meridiem"),n}function vt(s,e=22){const t=s.getDateWithAdjustedTimezone(),n=new d(s,{});return A(n,t),n.imply("hour",e),n.imply("meridiem",f.PM),n.addTag("casualReference/tonight"),n}function Lt(s,e=20){const t=new d(s,{});return t.imply("meridiem",f.PM),t.imply("hour",e),t.addTag("casualReference/evening"),t}function Vt(s){const e=new d(s,{});return s.getDateWithAdjustedTimezone().getHours()>2&&e.addDurationAsImplied({day:1}),e.assign("hour",0),e.imply("minute",0),e.imply("second",0),e.imply("millisecond",0),e.addTag("casualReference/midnight"),e}function jt(s,e=6){const t=new d(s,{});return t.imply("meridiem",f.AM),t.imply("hour",e),t.imply("minute",0),t.imply("second",0),t.imply("millisecond",0),t.addTag("casualReference/morning"),t}function Zt(s,e=15){const t=new d(s,{});return t.imply("meridiem",f.PM),t.imply("hour",e),t.imply("minute",0),t.imply("second",0),t.imply("millisecond",0),t.addTag("casualReference/afternoon"),t}function Kt(s){const e=new d(s,{});return e.imply("meridiem",f.AM),e.assign("hour",12),e.imply("minute",0),e.imply("second",0),e.imply("millisecond",0),e.addTag("casualReference/noon"),e}const Jt=/(now|today|tonight|tomorrow|overmorrow|tmr|tmrw|yesterday|last\s*night)(?=\W|$)/i;class qt extends m{innerPattern(e){return Jt}innerExtract(e,t){let n=e.refDate;const r=t[0].toLowerCase();let i=e.createParsingComponents();switch(r){case"now":i=kt(e.reference);break;case"today":i=zt(e.reference);break;case"yesterday":i=Gt(e.reference);break;case"tomorrow":case"tmr":case"tmrw":i=Bt(e.reference);break;case"tonight":i=vt(e.reference);break;case"overmorrow":i=q(e.reference,2);break;default:if(r.match(/last\s*night/)){if(n.getHours()>6){const a=new Date(n.getTime());a.setDate(a.getDate()-1),n=a}A(i,n),i.imply("hour",0)}break}return i.addTag("parser/ENCasualDateParser"),i}}const Xt=/(?:this)?\s{0,3}(morning|afternoon|evening|night|midnight|midday|noon)(?=\W|$)/i;class Qt extends m{innerPattern(){return Xt}innerExtract(e,t){let n=null;switch(t[1].toLowerCase()){case"afternoon":n=Zt(e.reference);break;case"evening":case"night":n=Lt(e.reference);break;case"midnight":n=Vt(e.reference);break;case"morning":n=jt(e.reference);break;case"noon":case"midday":n=Kt(e.reference);break}return n&&n.addTag("parser/ENCasualTimeParser"),n}}function en(s,e,t){const n=s.getDateWithAdjustedTimezone(),r=tn(n,e,t);let i=new d(s);return i=i.addDurationAsImplied({day:r}),i.assign("weekday",e),i}function tn(s,e,t){const n=s.getDay();switch(t){case"this":return _(s,e);case"last":return $e(s,e);case"next":return n==u.SUNDAY?e==u.SUNDAY?7:e:n==u.SATURDAY?e==u.SATURDAY?7:e==u.SUNDAY?8:1+e:e<n&&e!=u.SUNDAY?_(s,e):_(s,e)+7}return nn(s,e)}function nn(s,e){const t=$e(s,e),n=_(s,e);return n<-t?n:t}function _(s,e){const t=s.getDay();let n=e-t;return n<0&&(n+=7),n}function $e(s,e){const t=s.getDay();let n=e-t;return n>=0&&(n-=7),n}const sn=new RegExp(`(?:(?:\\,|\\(|\\（)\\s*)?(?:on\\s*?)?(?:(this|last|past|next)\\s*)?(${y(V)}|weekend|weekday)(?:\\s*(?:\\,|\\)|\\）))?(?:\\s*(this|last|past|next)\\s*week)?(?=\\W|$)`,"i"),rn=1,an=2,on=3;class ln extends m{innerPattern(){return sn}innerExtract(e,t){const n=t[rn],r=t[on];let i=n||r;i=i||"",i=i.toLowerCase();let a=null;i=="last"||i=="past"?a="last":i=="next"?a="next":i=="this"&&(a="this");const o=t[an].toLowerCase();let l;if(V[o]!==void 0)l=V[o];else if(o=="weekend")l=a=="last"?u.SUNDAY:u.SATURDAY;else if(o=="weekday"){const c=e.reference.getDateWithAdjustedTimezone().getDay();c==u.SUNDAY||c==u.SATURDAY?l=a=="last"?u.FRIDAY:u.MONDAY:(l=c-1,l=a=="last"?l-1:l+1,l=l%5+1)}else return null;return en(e.reference,l,a)}}const fn=new RegExp(`(this|last|past|next|after\\s*this)\\s*(${y(W)})(?=\\s*)(?=\\W|$)`,"i"),cn=1,dn=2;class un extends m{innerPattern(){return fn}innerExtract(e,t){const n=t[cn].toLowerCase(),r=t[dn].toLowerCase(),i=W[r];if(n=="next"||n.startsWith("after")){const l={};return l[i]=1,d.createRelativeFromReference(e.reference,l)}if(n=="last"||n=="past"){const l={};return l[i]=-1,d.createRelativeFromReference(e.reference,l)}const a=e.createParsingComponents();let o=new Date(e.reference.instant.getTime());return r.match(/week/i)?(o.setDate(o.getDate()-o.getDay()),a.imply("day",o.getDate()),a.imply("month",o.getMonth()+1),a.imply("year",o.getFullYear())):r.match(/month/i)?(o.setDate(1),a.imply("day",o.getDate()),a.assign("year",o.getFullYear()),a.assign("month",o.getMonth()+1)):r.match(/year/i)&&(o.setDate(1),o.setMonth(0),a.imply("day",o.getDate()),a.imply("month",o.getMonth()+1),a.assign("year",o.getFullYear())),a}}const gn=new RegExp("([^\\d]|^)([0-3]{0,1}[0-9]{1})[\\/\\.\\-]([0-3]{0,1}[0-9]{1})(?:[\\/\\.\\-]([0-9]{4}|[0-9]{2}))?(\\W|$)","i"),hn=1,mn=5,Te=2,ye=3,L=4;class Tn{groupNumberMonth;groupNumberDay;constructor(e){this.groupNumberMonth=e?ye:Te,this.groupNumberDay=e?Te:ye}pattern(){return gn}extract(e,t){const n=t.index+t[hn].length,r=t.index+t[0].length-t[mn].length;if(n>0&&e.text.substring(0,n).match("\\d/?$")||r<e.text.length&&e.text.substring(r).match("^/?\\d"))return;const i=e.text.substring(n,r);if(i.match(/^\d\.\d$/)||i.match(/^\d\.\d{1,2}\.\d{1,2}\s*$/)||!t[L]&&i.indexOf("/")<0)return;const a=e.createParsingResult(n,i);let o=parseInt(t[this.groupNumberMonth]),l=parseInt(t[this.groupNumberDay]);if((o<1||o>12)&&o>12)if(l>=1&&l<=12&&o<=31)[l,o]=[o,l];else return null;if(l<1||l>31)return null;if(a.start.assign("day",l),a.start.assign("month",o),t[L]){const c=parseInt(t[L]),g=Pe(c);a.start.assign("year",g)}else{const c=b(e.refDate,l,o);a.start.imply("year",c)}return a.addTag("parser/SlashDateFormatParser")}}const yn=new RegExp(`(this|last|past|next|after|\\+|-)\\s*(${S})(?=\\W|$)`,"i"),pn=new RegExp(`(this|last|past|next|after|\\+|-)\\s*(${G})(?=\\W|$)`,"i");class En extends m{allowAbbreviations;constructor(e=!0){super(),this.allowAbbreviations=e}innerPattern(){return this.allowAbbreviations?yn:pn}innerExtract(e,t){const n=t[1].toLowerCase();let r=O(t[2]);if(!r)return null;switch(n){case"last":case"past":case"-":r=Y(r);break}return d.createRelativeFromReference(e.reference,r)}}function wn(s){return s.text.match(/^[+-]/i)!=null}function pe(s){return s.text.match(/^-/i)!=null}class Dn extends ${shouldMergeResults(e,t,n){return e.match(/^\s*$/i)?wn(n)||pe(n):!1}mergeResults(e,t,n,r){let i=O(n.text);pe(n)&&(i=Y(i));const a=d.createRelativeFromReference(D.fromDate(t.start.date()),i);return new M(t.reference,t.index,`${t.text}${e}${n.text}`,a)}}function Ee(s){return s.text.match(/\s+(before|from)$/i)!=null}function An(s){return s.text.match(/\s+(after|since)$/i)!=null}class Pn extends ${patternBetween(){return/^\s*$/i}shouldMergeResults(e,t,n){return!e.match(this.patternBetween())||!Ee(t)&&!An(t)?!1:!!n.start.get("day")&&!!n.start.get("month")&&!!n.start.get("year")}mergeResults(e,t,n){let r=O(t.text);Ee(t)&&(r=Y(r));const i=d.createRelativeFromReference(D.fromDate(n.start.date()),r);return new M(n.reference,t.index,`${t.text}${e}${n.text}`,i)}}const Rn=new RegExp(`^\\s*(${k})`,"i"),Nn=1;class Mn{refine(e,t){return t.forEach(function(n){if(!n.start.isDateWithUnknownYear())return;const r=e.text.substring(n.index+n.text.length),i=Rn.exec(r);if(!i||i[0].trim().length<=3)return;e.debug(()=>{console.log(`Extracting year: '${i[0]}' into : ${n}`)});const a=z(i[Nn]);n.end!=null&&n.end.assign("year",a),n.start.assign("year",a),n.text+=i[0]}),t}}class On extends Se{constructor(){super()}isValid(e,t){const n=t.text.trim();return n===e.text.trim()?!0:n.toLowerCase()==="may"&&!e.text.substring(0,t.index).trim().match(/\b(in)$/i)?(e.debug(()=>{console.log(`Removing unlikely result: ${t}`)}),!1):n.toLowerCase().endsWith("the second")?(e.text.substring(t.index+t.text.length).trim().length>0&&e.debug(()=>{console.log(`Removing unlikely result: ${t}`)}),!1):!0}}class Ce{createCasualConfiguration(e=!1){const t=this.createConfiguration(!1,e);return t.parsers.push(new qt),t.parsers.push(new Qt),t.parsers.push(new qe),t.parsers.push(new un),t.parsers.push(new En),t.refiners.push(new On),t}createConfiguration(e=!0,t=!1){const n=Wt({parsers:[new Tn(t),new Ge(e),new ve,new je(t),new ln,new at,new ct(e),new gt(e),new yt(e)],refiners:[new ce]},e);return n.parsers.unshift(new nt(e)),n.refiners.unshift(new Pn),n.refiners.unshift(new Dn),n.refiners.unshift(new K),n.refiners.push(new ce),n.refiners.push(new Mn),n.refiners.push(new Et),n}}class N{parsers;refiners;defaultConfig=new Ce;constructor(e){e=e||this.defaultConfig.createCasualConfiguration(),this.parsers=[...e.parsers],this.refiners=[...e.refiners]}clone(){return new N({parsers:[...this.parsers],refiners:[...this.refiners]})}parseDate(e,t,n){const r=this.parse(e,t,n);return r.length>0?r[0].start.date():null}parse(e,t,n){const r=new xn(e,t,n);let i=[];return this.parsers.forEach(a=>{const o=N.executeParser(r,a);i=i.concat(o)}),i.sort((a,o)=>a.index-o.index),this.refiners.forEach(function(a){i=a.refine(r,i)}),i}static executeParser(e,t){const n=[],r=t.pattern(e),i=e.text;let a=e.text,o=r.exec(a);for(;o;){const l=o.index+i.length-a.length;o.index=l;const c=t.extract(e,o);if(!c){a=i.substring(o.index+1),o=r.exec(a);continue}let g=null;c instanceof M?g=c:c instanceof d?(g=e.createParsingResult(o.index,o[0]),g.start=c):g=e.createParsingResult(o.index,o[0],c);const x=g.index,Q=g.text;e.debug(()=>console.log(`${t.constructor.name} extracted (at index=${x}) '${Q}'`)),n.push(g),a=i.substring(x+Q.length),o=r.exec(a)}return n}}class xn{text;option;reference;refDate;constructor(e,t,n){this.text=e,this.option=n??{},this.reference=D.fromInput(t,this.option.timezones),this.refDate=this.reference.instant}createParsingComponents(e){return e instanceof d?e:new d(this.reference,e)}createParsingResult(e,t,n,r){const i=typeof t=="string"?t:this.text.substring(e,t),a=n?this.createParsingComponents(n):null,o=r?this.createParsingComponents(r):null;return new M(this.reference,e,i,a,o)}debug(e){this.option.debug&&(this.option.debug instanceof Function?this.option.debug(e):this.option.debug.debug(e))}}const X=new Ce,Sn=new N(X.createCasualConfiguration(!1));new N(X.createConfiguration(!0,!1));new N(X.createCasualConfiguration(!0));const $n=Sn;function Cn(s,e,t){return $n.parseDate(s,e,t)}export{Cn as p};
