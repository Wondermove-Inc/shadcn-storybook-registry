{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "natural-language-picker-story",
  "type": "registry:component",
  "title": "Natural Language Picker Story",
  "author": "Lloyd Richards <lloyd.d.richards@gmail.com>",
  "description": "Interactive Storybook stories demonstrating natural language date input parsing (e.g., 'tomorrow', 'next week')",
  "dependencies": [
    "chrono-node",
    "date-fns",
    "lucide-react"
  ],
  "registryDependencies": [
    "calendar",
    "popover",
    "input",
    "button"
  ],
  "files": [
    {
      "path": "src/registry/atoms/natural-language-picker-story/natural-language-picker.stories.tsx",
      "content": "\"use client\";\n\nimport type { Meta, StoryObj } from \"@storybook/nextjs-vite\";\nimport { parseDate } from \"chrono-node\";\nimport { CalendarIcon } from \"lucide-react\";\nimport * as React from \"react\";\nimport { expect, userEvent, waitFor, within } from \"storybook/test\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\n\nfunction formatDate(date: Date | undefined) {\n  if (!date) {\n    return \"\";\n  }\n\n  return date.toLocaleDateString(\"en-US\", {\n    day: \"2-digit\",\n    month: \"long\",\n    year: \"numeric\",\n  });\n}\n\nconst meta: Meta = {\n  title: \"ui/Calendar/Blocks/Natural Language Picker\",\n  tags: [\"autodocs\"],\n  parameters: {\n    layout: \"centered\",\n  },\n};\n\nexport default meta;\n\ntype Story = StoryObj<typeof meta>;\n\nexport const Default: Story = {\n  render: () => {\n    const [open, setOpen] = React.useState(false);\n    const [value, setValue] = React.useState(\"In 2 days\");\n    const [date, setDate] = React.useState<Date | undefined>(\n      parseDate(value) || undefined,\n    );\n    const [month, setMonth] = React.useState<Date | undefined>(date);\n\n    return (\n      <div className=\"flex flex-col gap-3\">\n        <Label htmlFor=\"date\" className=\"px-1\">\n          Schedule Date\n        </Label>\n        <div className=\"relative flex gap-2\">\n          <Input\n            id=\"date\"\n            value={value}\n            placeholder=\"Tomorrow or next week\"\n            className=\"bg-background pr-10\"\n            onChange={(e) => {\n              setValue(e.target.value);\n              const date = parseDate(e.target.value);\n              if (date) {\n                setDate(date);\n                setMonth(date);\n              }\n            }}\n            onKeyDown={(e) => {\n              if (e.key === \"ArrowDown\") {\n                e.preventDefault();\n                setOpen(true);\n              }\n            }}\n          />\n          <Popover open={open} onOpenChange={setOpen}>\n            <PopoverTrigger asChild>\n              <Button\n                id=\"date-picker\"\n                variant=\"ghost\"\n                className=\"absolute top-1/2 right-2 size-6 -translate-y-1/2\"\n              >\n                <CalendarIcon className=\"size-3.5\" />\n                <span className=\"sr-only\">Select date</span>\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto overflow-hidden p-0\" align=\"end\">\n              <Calendar\n                mode=\"single\"\n                selected={date}\n                captionLayout=\"dropdown\"\n                month={month}\n                onMonthChange={setMonth}\n                onSelect={(date) => {\n                  setDate(date);\n                  setValue(formatDate(date));\n                  setOpen(false);\n                }}\n              />\n            </PopoverContent>\n          </Popover>\n        </div>\n        <div className=\"text-muted-foreground px-1 text-sm\">\n          Your post will be published on{\" \"}\n          <span className=\"font-medium\">{formatDate(date)}</span>.\n        </div>\n      </div>\n    );\n  },\n};\n\nexport const ShouldParseNaturalLanguage: Story = {\n  name: \"when typing natural language, should parse and update date\",\n  tags: [\"!dev\", \"!autodocs\"],\n  render: () => {\n    const [open, setOpen] = React.useState(false);\n    const [value, setValue] = React.useState(\"In 2 days\");\n    const [date, setDate] = React.useState<Date | undefined>(\n      parseDate(value) || undefined,\n    );\n    const [month, setMonth] = React.useState<Date | undefined>(date);\n\n    return (\n      <div className=\"flex flex-col gap-3\">\n        <Label htmlFor=\"date\" className=\"px-1\">\n          Schedule Date\n        </Label>\n        <div className=\"relative flex gap-2\">\n          <Input\n            id=\"date\"\n            value={value}\n            placeholder=\"Tomorrow or next week\"\n            className=\"bg-background pr-10\"\n            data-testid=\"natural-language-input\"\n            onChange={(e) => {\n              setValue(e.target.value);\n              const date = parseDate(e.target.value);\n              if (date) {\n                setDate(date);\n                setMonth(date);\n              }\n            }}\n            onKeyDown={(e) => {\n              if (e.key === \"ArrowDown\") {\n                e.preventDefault();\n                setOpen(true);\n              }\n            }}\n          />\n          <Popover open={open} onOpenChange={setOpen}>\n            <PopoverTrigger asChild>\n              <Button\n                id=\"date-picker\"\n                variant=\"ghost\"\n                className=\"absolute top-1/2 right-2 size-6 -translate-y-1/2\"\n                data-testid=\"calendar-button\"\n              >\n                <CalendarIcon className=\"size-3.5\" />\n                <span className=\"sr-only\">Select date</span>\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto overflow-hidden p-0\" align=\"end\">\n              <Calendar\n                mode=\"single\"\n                selected={date}\n                captionLayout=\"dropdown\"\n                month={month}\n                onMonthChange={setMonth}\n                onSelect={(date) => {\n                  setDate(date);\n                  setValue(formatDate(date));\n                  setOpen(false);\n                }}\n              />\n            </PopoverContent>\n          </Popover>\n        </div>\n        <div\n          className=\"text-muted-foreground px-1 text-sm\"\n          data-testid=\"publish-message\"\n        >\n          Your post will be published on{\" \"}\n          <span className=\"font-medium\">{formatDate(date)}</span>.\n        </div>\n      </div>\n    );\n  },\n  play: async ({ canvasElement }) => {\n    const canvas = within(canvasElement);\n\n    // üéØ Î™©Ï†Å: ÏûêÏó∞Ïñ¥ ÏûÖÎ†• Ïãú chrono-nodeÍ∞Ä ÎÇ†ÏßúÎ•º ÌååÏã±ÌïòÍ≥† ÏóÖÎç∞Ïù¥Ìä∏ÌïòÎäîÏßÄ ÌôïÏù∏\n    const input = canvas.getByTestId(\"natural-language-input\");\n    await expect(input).toBeInTheDocument();\n\n    // Í∏∞Ï°¥ Í∞í ÌôïÏù∏\n    await expect(input).toHaveValue(\"In 2 days\");\n\n    // ÏûêÏó∞Ïñ¥ ÏûÖÎ†• Î≥ÄÍ≤Ω (\"tomorrow\"Î°ú Î≥ÄÍ≤Ω)\n    await userEvent.clear(input);\n    await userEvent.type(input, \"tomorrow\");\n\n    await waitFor(\n      () => {\n        // Input Í∞íÏù¥ Î≥ÄÍ≤ΩÎêòÏóàÎäîÏßÄ ÌôïÏù∏\n        expect(input).toHaveValue(\"tomorrow\");\n      },\n      { timeout: 2000 },\n    );\n\n    // Calendar Î≤ÑÌäº ÌÅ¥Î¶≠ÌïòÏó¨ Popover Ïó¥Í∏∞\n    const calendarButton = canvas.getByTestId(\"calendar-button\");\n    await userEvent.click(calendarButton);\n\n    await waitFor(\n      () => {\n        // PopoverÍ∞Ä Ïó¥Î†∏ÎäîÏßÄ ÌôïÏù∏ (CalendarÍ∞Ä ÌëúÏãúÎêòÎäîÏßÄ)\n        const calendar = canvas.getByRole(\"grid\");\n        expect(calendar).toBeInTheDocument();\n      },\n      { timeout: 2000 },\n    );\n  },\n};\n",
      "type": "registry:component"
    }
  ],
  "categories": [
    "atoms",
    "storybook",
    "calendar",
    "date-picker",
    "nlp"
  ]
}